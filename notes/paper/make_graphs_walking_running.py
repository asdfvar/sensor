#!/usr/bin/python
import numpy as np
import matplotlib.pyplot as plt

walking = np.array([0.84794, 0.909459, 0.850478, 0.906831, 0.862499, 0.926355, 0.906276, 0.900198, 0.938393, 0.934762, 0.920486, 0.864496, 0.921065, 0.854258, 0.900292, 0.894288, 0.908544, 0.888207, 0.901154, 0.921692, 0.890178, 0.887596, 0.828443, 0.904484, 0.849955, 0.916847, 0.899168, 0.91797, 0.932738, 0.936772, 0.95634, 0.906997, 0.931281, 0.875598, 0.920153, 0.838532, 0.904328, 0.904448, 0.918744, 0.946283, 0.921908, 0.930042, 0.86388, 0.923708, 0.885149, 0.918485, 0.896543, 0.917104, 0.935319, 0.906593, 0.914294, 0.906969, 0.929369, 0.858822, 0.894336, 0.824241, 0.904161, 0.830148, 0.874468, 0.785672, 0.899271, 0.940611, 0.907252, 0.913564, 0.877749, 0.929613, 0.912499, 0.925567, 0.866579, 0.929623, 0.93787, 0.939557, 0.955559, 0.925966, 0.933549, 0.843215, 0.914925, 0.858983, 0.899164, 0.866985, 0.90986, 0.92087, 0.896269, 0.93171, 0.909918, 0.929025, 0.888036, 0.940737, 0.894057, 0.931365, 0.934599, 0.928244, 0.92282, 0.921015, 0.951321, 0.913612, 0.904481, 0.839105, 0.896004, 0.8588, 0.896319, 0.854178, 0.885876, 0.900081, 0.91569, 0.935342, 0.922368, 0.929162, 0.895921, 0.926157, 0.867629, 0.893603, 0.878906, 0.917411, 0.91562, 0.94121, 0.944205, 0.919567, 0.943681, 0.911371, 0.947294, 0.956737, 0.956125, 0.958828, 0.947283, 0.966719, 0.924671, 0.940748, 0.889098, 0.927789, 0.875759, 0.905913, 0.896647, 0.907511, 0.933524, 0.920492, 0.923788, 0.893768, 0.913336, 0.865062, 0.913386, 0.883637, 0.903123, 0.866881, 0.903453, 0.920731, 0.88505, 0.939967, 0.901619, 0.934523, 0.889663, 0.926323, 0.901285, 0.908031, 0.909289, 0.923446, 0.934659, 0.934598, 0.949645, 0.908067, 0.910707, 0.869039, 0.927072, 0.905367, 0.925551, 0.912338, 0.905817, 0.936264, 0.880576, 0.92859, 0.843708, 0.879873, 0.826994, 0.905264, 0.911376, 0.917238, 0.933009, 0.898513, 0.937063, 0.892177, 0.946836, 0.91991, 0.924891, 0.933932, 0.934353, 0.921666, 0.839023, 0.904294, 0.859086, 0.896721, 0.86768, 0.893096, 0.890697, 0.921343, 0.930745, 0.936265, 0.939215, 0.918313, 0.946375, 0.919351, 0.935114, 0.923725, 0.934041, 0.941688, 0.939578, 0.956527, 0.940947, 0.933056, 0.898514, 0.945094, 0.88771, 0.904917, 0.907533, 0.92786, 0.946098, 0.948585, 0.962405, 0.929531, 0.933455, 0.923765, 0.941599, 0.919069, 0.940204, 0.947485, 0.948427, 0.952853, 0.942196, 0.957732, 0.899363, 0.925428, 0.884403, 0.924885, 0.90273, 0.916171, 0.927368, 0.930656, 0.916308, 0.890598, 0.934537, 0.887396, 0.936231, 0.929023, 0.938279, 0.946846, 0.943457, 0.96996, 0.922866, 0.956731, 0.859757, 0.907367, 0.899173, 0.91909, 0.928146, 0.909033, 0.922153, 0.885011, 0.929819, 0.880473, 0.90415, 0.85526, 0.904488, 0.925886, 0.928248, 0.926717, 0.914716, 0.932041, 0.879482, 0.898241, 0.857904, 0.895399, 0.856461, 0.888349, 0.893585, 0.903402, 0.914296, 0.915198, 0.93667, 0.91319, 0.95032, 0.932409, 0.94468, 0.965393, 0.957563, 0.941803, 0.903273, 0.947113, 0.88779, 0.923759, 0.855948, 0.905863, 0.895192, 0.885045, 0.858525, 0.820775, 0.891636])

jogging = np.array([0.614519,  0.613305, 0.623928, 0.605347, 0.611666, 0.626071, 0.61199, 0.610012, 0.664099, 0.657875, 0.647192, 0.662059, 0.661104, 0.64692, 0.627096, 0.632131, 0.611584, 0.617628, 0.625921, 0.61357, 0.604124, 0.6316, 0.623726, 0.618092, 0.630524, 0.628401, 0.616326, 0.624837, 0.627491, 0.612806, 0.641851, 0.651142, 0.639558, 0.637323, 0.650632, 0.644348, 0.614491, 0.633567, 0.633568, 0.616999, 0.62872, 0.634505, 0.620832, 0.62043, 0.630233, 0.616538, 0.60977, 0.625793, 0.616863, 0.610995, 0.625174, 0.622698, 0.615825, 0.627239, 0.632368, 0.615397, 0.622417, 0.632697, 0.616102, 0.617143, 0.633528, 0.625234, 0.618803, 0.614791, 0.621452, 0.62953, 0.639695, 0.640515, 0.626083, 0.63266, 0.639627, 0.626633, 0.626574, 0.640193, 0.633723, 0.62601, 0.630366, 0.62897, 0.618069, 0.628285, 0.631538, 0.620202, 0.623122, 0.62986, 0.619613, 0.617108, 0.638623, 0.635631, 0.626576, 0.637364, 0.637033, 0.625246, 0.642448, 0.650913, 0.641026, 0.635987, 0.650511, 0.647963, 0.610833, 0.623848, 0.625947, 0.611111, 0.617423, 0.627369, 0.617735, 0.612184, 0.626951, 0.625833, 0.613806, 0.625043, 0.625612, 0.613087, 0.627361, 0.634973, 0.625583, 0.622337, 0.63555, 0.633194, 0.598695, 0.615303, 0.616091, 0.606666, 0.638105, 0.646202, 0.638673, 0.634632, 0.646112, 0.644297, 0.608805, 0.650576, 0.651737, 0.639179, 0.644295, 0.652661, 0.644687, 0.596302, 0.621063, 0.618265, 0.605435, 0.615779, 0.620562, 0.606561, 0.617174, 0.629647, 0.625637, 0.616821, 0.628016, 0.629237, 0.599229, 0.607845, 0.615455, 0.602718, 0.61319, 0.626785, 0.62386, 0.611923, 0.631489, 0.630503, 0.620105, 0.628422, 0.630513, 0.623776, 0.593465, 0.614625, 0.610528, 0.625971, 0.635287, 0.635758, 0.624691, 0.631753, 0.634483, 0.614421, 0.614917, 0.612342, 0.60566, 0.595032, 0.615499, 0.613628, 0.601998, 0.611923, 0.616665, 0.60191, 0.603985, 0.618142, 0.611668, 0.604829, 0.615589, 0.615857, 0.603822, 0.607867, 0.606954, 0.600885, 0.603833, 0.629274, 0.617771, 0.618995, 0.630171, 0.622048, 0.617304, 0.616643, 0.615634, 0.611041, 0.622368, 0.629496, 0.624007, 0.632676, 0.640969, 0.62686, 0.626247, 0.645401, 0.639222, 0.631796, 0.644803, 0.643875, 0.630307, 0.610138, 0.617217, 0.605757, 0.607802, 0.618581, 0.613391, 0.60635, 0.619235, 0.617617, 0.605441, 0.614625, 0.619997, 0.60782, 0.628995, 0.639833, 0.635717, 0.626136, 0.638307, 0.637192, 0.612327, 0.619929, 0.626032, 0.608871, 0.62432, 0.636926, 0.633024, 0.62415, 0.638556, 0.634968, 0.591033, 0.635738, 0.638471, 0.634987, 0.632314, 0.638929, 0.638459, 0.614789, 0.626216, 0.625655, 0.600399, 0.604203, 0.621781, 0.614971, 0.610074, 0.630954, 0.630258, 0.61961, 0.62955, 0.632495, 0.622968, 0.603811, 0.619427, 0.614475, 0.619257, 0.629585, 0.628171, 0.617592, 0.625913, 0.628516, 0.617663, 0.612897, 0.628781, 0.626557, 0.616036, 0.617985, 0.617157, 0.607207, 0.63816, 0.644768, 0.634495, 0.630608, 0.644925, 0.642234, 0.612104, 0.6254, 0.626011, 0.599778, 0.605193, 0.613452, 0.603763, 0.627557, 0.640229, 0.638329, 0.625892, 0.636921, 0.640176, 0.626801, 0.63102, 0.641376, 0.636244, 0.628073, 0.606758, 0.60415, 0.601758, 0.613391, 0.638905, 0.628055, 0.63089, 0.640854, 0.637602, 0.628038, 0.62174, 0.620723, 0.609626, 0.634517, 0.637714, 0.627688, 0.626813, 0.639328, 0.636243, 0.623253, 0.635577, 0.636409, 0.611054, 0.618438, 0.639176, 0.634793, 0.628122, 0.640431, 0.638024, 0.626532, 0.617991, 0.618261, 0.612128, 0.611423, 0.621112, 0.614782, 0.602006, 0.611772, 0.612489, 0.602481, 0.621333, 0.629679, 0.621492, 0.617974, 0.629755, 0.627368, 0.593013, 0.612036, 0.615967, 0.611519, 0.619639, 0.628805, 0.616176, 0.615627, 0.641315, 0.635939, 0.623572, 0.638506, 0.637238, 0.623079, 0.627678, 0.631802, 0.626995, 0.621159, 0.63377, 0.631115, 0.618395, 0.623869, 0.625168, 0.614915, 0.621534, 0.630017, 0.624662, 0.619594, 0.629691, 0.626559, 0.602957, 0.611791, 0.617923, 0.60719, 0.619258, 0.630752, 0.627741, 0.618223, 0.629981, 0.629351, 0.610359, 0.620112, 0.621404, 0.608451, 0.848015, 0.846191, 0.851129, 0.905617, 0.897348, 0.906613, 0.906279, 0.881788, 0.879403, 0.856607, 0.860073, 0.85638, 0.844661, 0.814274, 0.813246, 0.85427, 0.773457, 0.865956, 0.762265, 0.845937, 0.781634])

threshold = np.linspace(0, 1, 1000)
walking_prob = np.zeros(len(threshold), dtype='float64')
for k in range(len(walking_prob)):
   walking_prob[k] = sum(walking > threshold[k])
walking_prob /= len(walking)
jogging_prob = np.zeros(len(threshold), dtype='float64')
for k in range(len(jogging_prob)):
   jogging_prob[k] = sum(jogging > threshold[k])
jogging_prob /= len(jogging)

plt.figure(figsize=(12,9))
walking_plot, = plt.plot(threshold, walking_prob, lw=4, color='#000000', label="Walking data")
jogging_plot, = plt.plot(threshold, jogging_prob, lw=4, color='#888888', label="Jogging data")
plt.title("Matched-Filter Correlation with Reference: Walking", fontsize=26)
plt.xlabel("Correlation Threshold", fontsize=26)
plt.ylabel("Fraction Exceeding Threshold", fontsize=26)
plt.yticks(fontsize=20)
plt.xticks(fontsize=20)
plt.legend(handles=[walking_plot, jogging_plot], loc='lower left', prop={'size':26})
plt.savefig("fraction_threshold_walking_to_jogging.png", bbox_inches="tight")

plt.figure(figsize=(12, 9))
plt.ylim(0,1)
plt.title("ROC Curve (Walking vs. Jogging)", fontsize=26)
plt.ylabel("Walking Classified as Walking", fontsize=26)
plt.xlabel("Jogging Classified as Walking", fontsize=26)
plt.yticks(np.linspace(0, 1, 11), fontsize=20)
plt.xticks(np.linspace(0, 1, 11), fontsize=20)
plt.plot(jogging_prob, walking_prob, lw=8, color='#000000')
plt.savefig("ROC_walk_to_run.png", bbox_inches="tight")
